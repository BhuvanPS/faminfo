<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Photo Tagging</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the image map container */
        .image-container {
            /* Ensures the image is centered and handles overflow */
            max-width: 100%;
            overflow-x: auto;
            display: inline-block;
        }

        /* Basic styling for the image itself */
        #group-photo {
            max-width: 100%;
            height: auto;
            border-radius: 0.5rem; /* Rounded corners for the image */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        /* Styling for the new bubble box */
        #bubble-box {
            /* Ensures the element is always on top and hidden until clicked */
            z-index: 50;
        }
        
        /* Optional: Retaining the static box for instructions, though its purpose is changed */
        #instruction-display {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col items-center p-4 min-h-screen font-[Inter]">

    <!-- Header Card -->
    <header class="w-full max-w-4xl bg-white p-6 rounded-xl shadow-lg mb-8">
        <h1 class="text-3xl font-extrabold text-gray-800 text-center">
            Clickable Group Photo Viewer
        </h1>
        <p class="text-center text-gray-500 mt-2">
            Click on any person in the photo to display their name in a bubble above their head.
        </p>
    </header>

    <!-- Main Content Area -->
    <main class="w-full max-w-4xl bg-white p-6 rounded-xl shadow-lg">

        <!-- Image Container - CRITICAL: Must be 'relative' for the bubble to be positioned correctly -->
        <div class="image-container mx-auto relative">
            <!-- 
                NOTE: Please replace the 'src' with your actual image path: "IMG_0054.JPG". 
                A large placeholder is used to match your coordinate scale.
            -->
            <img 
                src="IMG_0054.JPG" 
                usemap="#image-map" 
                id="group-photo" 
                alt="Group Photo"
            >

            <!-- NEW: Bubble Box -->
            <div id="bubble-box" 
                 class="absolute hidden p-2 bg-blue-600 text-white text-lg font-semibold rounded-lg shadow-xl whitespace-nowrap pointer-events-none transform -translate-x-1/2 -translate-y-full z-10">
                <div id="bubble-name"></div>
                <!-- Simple triangle pointer using CSS borders -->
                <div class="absolute w-0 h-0 border-t-[8px] border-solid border-t-blue-600 border-x-transparent border-b-transparent left-1/2 -ml-[4px] bottom-[-8px]"></div>
            </div>
            <!-- END NEW -->
        </div>

        <!-- Image Map Generated by http://www.image-map.net/ -->
        <map name="image-map">
            <!-- 
                CRITICAL CHANGE: Now passing 'this' (the <area> element) to showName 
                so we can get its scaled coordinates.
            -->
            <area target="" alt="Karthik" title="Karthik" href="javascript:void(0)" 
                  coords="615,790,165" shape="circle" onclick="showName(this, 'Karthik')">
            <area target="" alt="Veena" title="Veena" href="javascript:void(0)" 
                  coords="1018,948,167" shape="circle" onclick="showName(this, 'Veena')">
            <area target="" alt="Dheeraj" title="Dheeraj" href="javascript:void(0)" 
                  coords="1517,815,174" shape="circle" onclick="showName(this, 'Dheeraj')">
            <area target="" alt="Suri" title="Suri" href="javascript:void(0)" 
                  coords="2035,817,226" shape="circle" onclick="showName(this, 'Suri')">
            
            <!-- Add the rest of your 50+ areas here following the same format, passing 'this' -->

        </map>

        <!-- Static Instruction/Message Display Card (repurposed) -->
        <div id="instruction-display" class="mt-8 p-4 bg-gray-100 text-gray-600 font-medium text-center text-lg rounded-md shadow-inner">
            Click on a person to see their name appear in a bubble above their head!
        </div>
        
    </main>

    <!-- JavaScript for Interactivity and Responsive Scaling -->
    <script>
        const ORIGINAL_IMAGE_WIDTH = 2500; // Based on the magnitude of your provided coordinates
        let bubbleTimer; // Global timer for hiding the bubble

        /**
         * Function to automatically scale the image map coordinates based on 
         * the current displayed size of the image versus its original size.
         */
        function resizeImageMap() {
            const img = document.getElementById('group-photo');
            const map = document.querySelector('map[name="image-map"]');

            if (!img || !map || img.clientWidth === 0) return;

            // Get the current displayed width of the image
            const currentWidth = img.clientWidth;
            // Calculate the scaling ratio
            const ratio = currentWidth / ORIGINAL_IMAGE_WIDTH;

            Array.from(map.areas).forEach(area => {
                // 1. Store original coordinates if not already present
                let originalCoords = area.getAttribute('data-original-coords');
                if (!originalCoords) {
                    originalCoords = area.coords;
                    area.setAttribute('data-original-coords', originalCoords);
                }

                // 2. Split and scale the coordinates
                const scaledCoords = originalCoords.split(',').map(coord => 
                    Math.round(parseInt(coord, 10) * ratio)
                ).join(',');

                // 3. Apply the new scaled coordinates
                area.coords = scaledCoords;
            });
        }

        /**
         * Function to display the name in a bubble box positioned over the clicked area.
         * @param {HTMLElement} areaElement - The clicked <area> element.
         * @param {string} personName - The name of the person clicked.
         */
        function showName(areaElement, personName) {
            const bubbleBox = document.getElementById('bubble-box');
            const bubbleName = document.getElementById('bubble-name');
            const coords = areaElement.coords.split(',').map(c => parseInt(c, 10));

            // Coordinates for a circle shape are: x_center, y_center, radius
            const x_center = coords[0];
            const y_center = coords[1];

            // 1. Update the content
            bubbleName.textContent = personName;
            
            // 2. Set the position relative to the image container
            // The bubble box has 'transform -translate-x-1/2 -translate-y-full' in its classes.
            // This centers the bubble horizontally and moves it up (relative to the click spot).
            bubbleBox.style.left = `${x_center}px`;
            bubbleBox.style.top = `${y_center}px`;

            // 3. Make the box visible
            bubbleBox.classList.remove('hidden');
            
            // 4. Hide it after a short time (2 seconds)
            clearTimeout(bubbleTimer);
            bubbleTimer = setTimeout(() => {
                bubbleBox.classList.add('hidden');
            }, 2000);

            // Optional: Update the instruction box below
            document.getElementById('instruction-display').textContent = `Name displayed: ${personName}`;
        }

        // Run the scaling function when the page loads, the image loads, and the window resizes
        document.addEventListener('DOMContentLoaded', resizeImageMap);
        window.addEventListener('resize', resizeImageMap);
        // This is crucial for cached images
        const img = document.getElementById('group-photo');
        if (img.complete) {
            resizeImageMap();
        } else {
            img.onload = resizeImageMap;
        }

    </script>

</body>
</html>
